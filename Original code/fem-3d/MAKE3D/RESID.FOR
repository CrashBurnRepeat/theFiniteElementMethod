      SUBROUTINE RESID
      COMMON/VK/NNODE,NELEM,NTYPE,RHOCP,NTIME,TIME,NNRA,TO,TAMB
      COMMON/VD/AF,AFM,DT,NNQS,NUMN,NUM,NNHC,NNST,NSTOP,KPRNT,IFLAG
      COMMON/VA/COLD(81),CNEW(81),KNODE(81),FIXED(81),E(81),AB(81)
      INTEGER LOC,ERRPRN
      REAL MAXERR
      DATA ERRPRN/10/
C
      MAXERR = 0.0
      MAXRES=0
      ERR=0.0001
      DO 1 I=1,NNODE
      RR=ABS(CNEW(I)-COLD(I))
      MAXERR=MAX(RR,MAXERR)
      IF(RR.GT.ERR)THEN
          MAXRES = 1
          LOC    = I
      ENDIF
    1 CONTINUE
C
      IF(MOD(NTIME,ERRPRN).EQ.0)THEN
         WRITE(*,101)NTIME,MAXERR,LOC
      ENDIF
      IF(MAXRES.EQ.1)THEN
      IF(NTIME.EQ.NSTOP)THEN
        WRITE(*,102)NTIME,RR
         CALL PRINT
          CALL PRINTF
         STOP
        ENDIF
      RETURN
       ELSE
        WRITE(*,100)NTIME
         CALL PRINT
          CALL PRINTF
         STOP
        END IF
  100 FORMAT('0',2X,'PROGRAM HAS CONVERGED IN',I3,' STEPS')
  101 FORMAT('0',2X,'TIME=',I4,2X,'ERROR=',1PE12.5,2X,'NODE=',I4)
  102 FORMAT('0',2X,'PROGRAM HAS NOT CONVERGED IN ',I3,' STEPS',/,3X,'TH
     *E RESIDUAL VALUE IS ',F8.4)
      RETURN
      END
C ----------------------------------------------------------------------
      SUBROUTINE PRINTF
      COMMON/VK/NNODE,NELEM,NTYPE,RHOCP,NTIME,TIME,NNRA,TO,TAMB
      COMMON/VA/COLD(81),CNEW(81),KNODE(81),FIXED(81),E(81),AB(81)
      COMMON/VZ/X(81),Y(81),Z(81),QQ(81),AREA(81),VOLUME(81)
      COMMON/TI/TITLE(18)
      WRITE(8,'(18A)')TITLE
      WRITE(8,'(I4)')NTIME
      WRITE(8,'(2I4)')NNODE,NELEM
      DO 1 I=1,NNODE
    1 WRITE(8,100)I,X(I),Y(I),Z(I),CNEW(I)
  100 FORMAT(5X,I3,7(F8.3,1X))
      RETURN
      END
C ----------------------------------------------------------------------
      SUBROUTINE SETPC
      COMMON/VD/AF,AFM,DT,NNQS,NUMN,NUM,NNHC,NNST,NSTOP,KPRNT,IFLAG
      CHARACTER INFIL*12,OUTFIL*12
      DATA INFIL/'            '/,OUTFIL/'            '/
      WRITE(*,105)
  105 FORMAT(1X,'IF YOU WANT HARDCOPY OUTPUT, PRESS CTL-PRTSC NOW')
      WRITE(*,'(/1X,A\)')' ENTER NAME FOR INPUT FILE: '
      READ(*,'(BN,A)')INFIL
      OPEN(5,FILE=INFIL)
C
      WRITE(*,'(/1X,A\)')' ENTER NAME FOR PLOT OUTPUT FILE: '
      READ(*,'(BN,A)')OUTFIL
      OPEN(8,FILE=OUTFIL,STATUS='NEW')
      WRITE(8,'(A)')OUTFIL
C
      WRITE(*,'(/1X,A\)')' ENTER 1 FOR GAUSS-SEIDEL ITERATION OR 2 FOR G
     1AUSSIAN ELIMINATION: '
      READ(*,'(I1)')IFLAG
C
      RETURN
      END
