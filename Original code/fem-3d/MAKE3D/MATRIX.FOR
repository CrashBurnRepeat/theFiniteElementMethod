      SUBROUTINE MATRIX
      COMMON/VA/COLD(81),CNEW(81),KNODE(81),FIXED(81),E(81),AB(81)
      COMMON/VV/A(81,81),P(81,81),R(81,81),B(81)
      COMMON/VZ/X(81),Y(81),Z(81),QQ(81),AREA(81),VOLUME(81)
      COMMON/VK/NNODE,NELEM,NTYPE,RHOCP,NTIME,TIME,NNRA,TO,TAMB
      COMMON/VC/Q(81),F(81),NTS(81),NQS(81),DX(81),DY(81),DZ(81)
      COMMON/VD/AF,AFM,DT,NNQS,NUMN,NUM,NNHC,NNST,NSTOP,KPRNT,IFLAG
      COMMON/VM/H(81),TINF(81),TH(81),FORM(81),HR(81)
C
      CALL CLEAR(B,NNODE)
C
C     CALCULATE RADIATION EFFECT
C
      IF(NNRA.NE.0)CALL RADIAN
C
C     CALCULATE LOAD VECTOR (RHS PLUS VALUES AT TIME LEVEL N)
C
    4 DO 2 L=1,NNODE
      B(L)=F(L)
      DO 2 LL=1,NNODE
      B(L)=B(L)+(AFM*A(L,LL)+P(L,LL)/DT)*COLD(LL)
    2 CONTINUE
C
C     THIS WRITE STATEMENT ALLOWS YOU TO EXAMINE THE B COLUMN VECTOR
C
C     write(*,102),ntime
C     do 3 i=1,nnode
C   3 write(*,34)b(i)
C 102 format(/,2x,'values of b at n=',i4)
C  34 format(2x,f8.4)
C
      IF(IFLAG.EQ.1)THEN
       CALL SEIDEL
        ELSE
          DO 3 K=1,NNST
         L=NTS(K)
    3   B(L)=0.0
       CALL GAUSSR(CNEW,NNODE)
      ENDIF
      RETURN
      END
