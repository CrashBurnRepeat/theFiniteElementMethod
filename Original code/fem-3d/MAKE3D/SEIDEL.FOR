      SUBROUTINE SEIDEL
      COMMON/VA/COLD(81),CNEW(81),KNODE(81),FIXED(81),E(81),AB(81)
      COMMON/VV/A(81,81),P(81,81),R(81,81),B(81)
      COMMON/VK/NNODE,NELEM,NTYPE,RHOCP,NTIME,TIME,NNRA,TO,TAMB
      COMMON/VC/Q(81),F(81),NTS(81),NQS(81),DX(81),DY(81),DZ(81)
      COMMON/VD/AF,AFM,DT,NNQS,NUMN,NUM,NNHC,NNST,NSTOP,KPRNT,IFLAG
C
      RES=.0005
      IF(NTYPE.EQ.1)GOTO 500
C
  200 AMAX=0.0
      DO 400 L=1,NNODE
      IF(KNODE(L).EQ.1)GO TO 400
      OLDVAL=CNEW(L)
      SUM=0.0
      DO 300 JJ=1,NNODE
      IF(JJ.EQ.L)GO TO 300
      SUM=SUM+(AF*A(L,JJ)+P(L,JJ)/DT)*CNEW(JJ)
  300 CONTINUE
      S=AF*A(L,L)+P(L,L)/DT
      CNEW(L)=(-SUM+B(L))/S
      ERR=ABS(CNEW(L)-OLDVAL)
      IF(ERR.GT.AMAX)AMAX=ERR
  400 CONTINUE
      IF(AMAX.GT.RES)GO TO 200
      RETURN
C
  500 AMAX=0.0
      DO 850 L=1,NNODE
      IF(KNODE(L).EQ.1)GO TO 850
      OLDVAL=CNEW(L)
      SUM=0.0
      DO 900 JJ=1,NNODE
      IF(JJ.EQ.L)GO TO 900
      SUM=SUM+A(L,JJ)*CNEW(JJ)
  900 CONTINUE
      IF(A(L,L).EQ.0.)GO TO 850
      CNEW(L)=(-SUM+F(L))/A(L,L)
      ERR=ABS(CNEW(L)-OLDVAL)
      IF(ERR.GT.AMAX)AMAX=ERR
  850 CONTINUE
      IF(AMAX.GT.RES)GO TO 500
      RETURN
      END
