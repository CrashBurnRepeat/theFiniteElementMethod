      SUBROUTINE INIT
      COMMON/VA/COLD(81),CNEW(81),KNODE(81),FIXED(81),E(81),AB(81)
      COMMON/VC/Q(81),F(81),NTS(81),NQS(81),DX(81),DY(81),DZ(81)
      COMMON/VZ/X(81),Y(81),Z(81),QQ(81),AREA(81),VOLUME(81)
      COMMON/VD/AF,AFM,DT,NNQS,NUMN,NUM,NNHC,NNST,NSTOP,KPRNT,IFLAG
      COMMON/VM/H(81),TINF(81),TH(81),FORM(81),HR(81)
      COMMON/VK/NNODE,NELEM,NTYPE,RHOCP,NTIME,TIME,NNRA,TO,TAMB
      COMMON/VL/NODE(81,4),NODEF(81,3),NODEC(81,3),NOR1(81,3),NOR2(81,3)
      COMMON/TI/TITLE(18)
      CHARACTER*4 STOP(4),WORD
      DATA STOP/'DIRC','FLUX','CONV','RADI'/
C
      CALL SETPC
C
      READ(5,100)TITLE
  100 FORMAT(18A4)
      WRITE(*,101)TITLE
  101 FORMAT('0',5X,18A4)
C
      READ(5,*)NNODE,NELEM,NUMN,NSTOP,KPRNT
      READ(5,*)NTYPE,DT,AF,RHOCP,TO,TAMB
      IF(NUMN.EQ.3)THEN
        NUM=2
         ELSE
        NUM=3
      ENDIF
      DO 33 I=1,NNODE
      CNEW(I)=0.
      COLD(I)=TO
      NTS(I)=0
      NQS(I)=0
      X(I)=0.
      Y(I)=0.
      Z(I)=0.
      QQ(I)=0.
      Q(I)=0.
      F(I)=0.
      FIXED(I)=0.
      KNODE(I)=0
      H(I)=0.
      TINF(I)=0.
      DX(I)=0.
      DY(I)=0.
      DZ(I)=0.
      DO 34 K=1,4
   34 NODE(I,K)=0
   33 CONTINUE
C
      DO 104 J=1,NNODE
      READ(5,*)I,X(I),Y(I),Z(I)
  104 CONTINUE
C
      DO 105 I=1,NELEM
      READ(5,*)J,QQ(J),DX(J),DY(J),DZ(J),TH(J),(NODE(J,MM),MM=1,NUMN)
  105 CONTINUE
C
      DO 110 I=1,NNODE
      READ(5,1015)WORD,NT,CNT
      IF (WORD.EQ.STOP(1))GOTO 120
      NTS(I)=NT
      COLD(NT)=CNT
      KNODE(NT)=1
      FIXED(NT)=CNT
  110 CONTINUE
  120 NNST=I-1
C
      DO 130 I=1,NELEM
      READ(5,1016)WORD,Q(I),(NODEF(I,J),J=1,NUM)
      IF(WORD.EQ.STOP(2))GO TO 135
  130 CONTINUE
  135 NNQS=I-1
C
      DO 140 I=1,NELEM
      READ(5,1017)WORD,H(I),TINF(I),(NODEC(I,J),J=1,NUM)
      IF(WORD.EQ.STOP(3))GO TO 145
  140 CONTINUE
  145 NNHC=I-1
C
      DO 147 I=1,NELEM
      READ(5,1018)WORD,HR(I),E(I),AB(I),FORM(I),(NOR1(I,J),J=1,NUM)
     *            ,(NOR2(I,J),J=1,NUM)
      IF(WORD.EQ.STOP(4))GO TO 148
  147 CONTINUE
  148 NNRA=I-1
C
      IF(NTYPE.EQ.1)WRITE(*,14)NTYPE
      IF(NTYPE.EQ.2)WRITE(*,15)NTYPE
      AFM=AF-1.0
      IF(NTYPE.EQ.1)GO TO 1
      IF(AF.EQ.1.)WRITE(*,10)DT
      IF(AF.EQ.0.5)WRITE(*,11)DT
    1 WRITE(*,12)NSTOP,KPRNT,TO,TAMB
      WRITE(*,1035)NNODE,NELEM
      WRITE(*,1040)
      WRITE(*,1041)
      DO 150 I=1,NNODE
      WRITE(*,1045)I,X(I),Y(I),Z(I)
  150 CONTINUE
      WRITE(*,1050)
      DO 155 I=1,NELEM
      WRITE(*,1055)I,QQ(I),DX(I),DY(I),DZ(I),(NODE(I,MM),MM=1,NUMN)
  155 CONTINUE
      WRITE(*,1060)
      WRITE(*,1061)
      DO 160 I=1,NNST
      WRITE(*,1065)I,NTS(I),COLD(NTS(I))
  160 CONTINUE
      WRITE(*,1080)
      WRITE(*,1082)
      DO 170 I=1,NNQS
      WRITE(*,1085)I,Q(I),(NODEF(I,J),J=1,NUM)
  170 CONTINUE
      WRITE(*,1081)
      WRITE(*,1083)
      DO 180 I=1,NNHC
      WRITE(*,1086)I,H(I),TINF(I),(NODEC(I,J),J=1,NUM)
  180 CONTINUE
      WRITE(*,1087)
      WRITE(*,1088)
      DO 183 I=1,NNRA
      IF(NUM.EQ.2)THEN
      WRITE(*,1089)I,HR(I),E(I),AB(I),FORM(I),(NOR1(I,J),J=1,NUM),
     *             (NOR2(I,J),J=1,NUM)
      ELSE
      WRITE(*,1090)I,HR(I),E(I),AB(I),FORM(I),(NOR1(I,J),J=1,NUM),
     *             (NOR2(I,J),J=1,NUM)
      ENDIF
  183 CONTINUE
C
      WRITE(*,191)
  191 FORMAT('0',5X,'PLEASE WAIT, SOLUTION IS PROCEEDING')
C
   10 FORMAT('0',10X,'FULLY IMPLICIT ',2X,'DT=',F7.4)
   11 FORMAT('0',10X,'CRANK NICOLSON ',2X,'DT=',F7.4)
   12 FORMAT('0',5X,'NSTOP=',I5,2X,'KPRNT=',I4,2X,'TO=',F8.3,2X,
     *'T AMBIENT=',F8.3)
   14 FORMAT('0',10X,'NTYPE=',I2,2X,'STEADY STATE CNEW')
   15 FORMAT('0',10X,'NTYPE=',I2,2X,'TIME DEPENDENT CNEW')
 1015 FORMAT(6X,A4,I5,5X,F10.5)
 1016 FORMAT(6X,A4,F10.5,3I5)
 1017 FORMAT(6X,A4,2F10.5,3I5)
 1018 FORMAT(6X,A4,4F10.5,6I3)
 1035 FORMAT('0',10X,'NO. OF NODES=',I4,5X,'NO.OF ELEMENTS=',I4)
 1040 FORMAT('0',8X,'NODAL COORDINATE VALUES')
 1041 FORMAT('0',7X,'I',9X,'X',11X,'Y',11X,'Z')
 1045 FORMAT(5X,I4,3(4X,F8.4))
 1050 FORMAT('0',1X,'ELEMENT',3X,'SOURCE',4X,'DX',6X,'DY',6X,'DZ',6X,'NO
     $DE NUMBERS')
 1055 FORMAT(2X,I4,3X,4F8.3,3X,4(1X,I3))
 1060 FORMAT('0',7X,'NODES WHERE CNEW IS SPECIFIED')
 1061 FORMAT('0',10X,'I',5X,'NODE',6X,'CNEW')
 1065 FORMAT(4X,2(4X,I4),5X,F8.3)
 1080 FORMAT('0',7X,'NODES WHERE FLUX IS SPECIFIED')
 1081 FORMAT('0',7X,'NODES WHERE CONV IS SPECIFIED')
 1082 FORMAT('0',10X,'I',6X,'FLUX',5X,'NODE NUMBERS')
 1083 FORMAT('0',10X,'I',7X,'H',7X,'TINF',7X,'NODE NUMBERS')
 1085 FORMAT(8X,I4,2X,F8.3,4X,3I5)
 1086 FORMAT(8X,I4,2X,2(F8.3,2X),3X,3I5)
 1087 FORMAT('0',7X,'NODES WHERE RADIATION IS SPECIFIED')
 1088 FORMAT('0',10X,'I',6X,'HR',6X,'E',6X,'AB',6X,'FORM',6X,'ELE1 NODES
     *',5X,'ELE2 NODES')
 1089 FORMAT(8X,I4,2X,3F7.3,2X,F7.3,5X,2I5,5X,2I5)
 1090 FORMAT(8X,I4,2X,3F7.3,2X,F7.3,5X,3I5,2X,3I5)
      RETURN
      END
